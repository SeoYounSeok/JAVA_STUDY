#### JPA

```
* 시작하기에 앞서 한번 생각해보고 들어가는 것을 추천한다.

관계형 데이터베이스는 " 어떻게 데이터를 저장할지에 초점이 맞춰진 기술 " 입니다.
반대로, 객체지향 프로그래밍 언어는 메세지를 기반으로 " 기능과 속성을 한 곳에서 관리하는 기술 " 이라 합니다.

 관계형 데이터베이스와 객체지향 프로그래밍 언어의 패러다임이 서로 다른데, 객체를 데이터베이스에 저장하려고 하니,
 여러 문제가 발생합니다. 이를 " 패러다임 불일치 " 라고 합니다.

- pg 81 -


* JPA란?

 서로 지행하는 바가 다른 2개 영역을 중간에서 패러다임 일치를 시켜주기 위한 기술입니다.
 즉 개발자는 객체지향적 프로그래밍을 하고 JPA가 이를 관계형 데이터베이스에 맞게 SQL을 대신 생성해서 실행합니다.

 개발자는 항상 객체지향적 코드를 표현할 수 있으니, 더는 SQL에 종속적인 개발을 하지 않아도 됩니다.

 * 실무에서 JPA

 실무에서 JPA를 사용하지 못하는 가장 큰 이유는 높은 러닝 커브를 이야기합니다. 동의하며!!!
 JPA를 잘 사용하기 위해서는 객체지향 프로그래밍과 관계형 데이터베이스를 둘 다 알아야합니다.

```

#### 프로젝트에 Spring Data JPA 적용하기

```
* 코드
    compile('org.springframework.boot:spring-boot-starter-data-jpa') // 1
    compile('com.h2database:h2') // 2

1. spring-boot-starter-data-jpa
  - 스프링 부트용 Spring Data Jpa 추상화 라이브러리 입니다.
  - 스프링 부트 버전에 맞춰 자동으로 JPA관련 라이브러리들의 버전을 관리해 줍니다.

2. h2
  - 인메모리 관계형 데이터베이스 입니다.
  - 별도의 설치가 필요 없이 프로젝트 의존성만으로 관리할 수 있습니다.
  - 메모리에서 실행되기 때문에 애플리케이션을 재시작할 때마다 초기화된다는 점을 이용하여 테스트 용도로 많이 사용됩니다.
  - JPA의 테스트, 로컬 환경에서의 구동에서 사용할 예정입니다.
```

##### Post 클래스 특이점

```
* 생각해보자.
  자바빈 규약을 생각하면서, getter/setter 를 무작정 세팅하는 경우가 있습니다.
  이렇게 되면, 해당 클래스의 인스턴스 값들이 언제 어디서 변해야 하는지 코드상으로 명확하게 구분할 수가 없어,
  차후 기능 변경 시 복잡해질 수 있습니다.

  ! 그래서 Entity 클래스에서는 절때 Setter 메소드를 만들지 않습니다.

  대신, 해당 필드의 값 변경이 필요하면, 명확히 그 목적과 의도를 나타낼 수 있는 메소드를 추가해야만 합니다.
```

##### Setter 코드 비교

```
* 잘못된 코드

public class Order {
  public void setStatus(boolean status){
    this.status = status
  }
}

public void 주문서비스의_취소이벤트() {
  order.setStatus(false);
}

* 올바른 사용 예

public class Order {
  public void cancelOrder() {
    this.status = status
  }
}

public void 주문서비스의_취소이벤트(){
  order.cancelOrder()
}
```

##### Setter 가 없는 이 상황에서 어떻게 값을 채워 DB 에 삽입 해야 할까요?

```
기본적인 구조는 생성자를 통해 최종값을 채운  후 DB에 삽입하는 것이며,
값 변경이 필요한 경우 해당 이벤트에 맞는 public 메소드를 호출하여 변경하는 것을 전제로 합니다.

이 책에서는 생성자 대신 @Builder 를 통해 제공되는 빌더 클래스를 사용합니다.
생성자나 빌더나 생성 시점에 값을 채워주는 역할은 똑같습니다.
다만 생성자의 경우 지금 채워야할 필드가 무엇인지 명확히 지정할 수가 없습니다.

예를 들어 다음과 같은 생성자가 있다면 개발자가 new Example(b, a) 처럼
a와 b의 위치를 변경해도 코드가 실행되기 전까지는 문제를 찾을 수 가 없습니다.

public Example(String a, String b) {
  this.a = a;
  this.b = b;
}

하지만 빌더를 사용하게 되면 다음과 같이 어느 필드에 어떤 값을 채워야할지 명확하게 인지할 수 있습니다.

Example.builder()
    .a(a)
    .b(b)
    .build()


앞으로 모든 예제는 빌더 패턴을 적극적으로 사용하니 익히는 것에 중점을 둡시다.

* 간단 팁
  스프링 부트에서는 application.properties, application.yml 등의 파일에
  한 줄의 코드로 설정할 수 있도록 지원하고 권장하니 이를 사용하겠습니다.
  spring 프로젝트의 경우, src/main/resource > application.properties 파일을 생성해야 한다.
```
